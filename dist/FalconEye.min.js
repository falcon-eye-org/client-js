(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}var __decorate=void 0&&(void 0).__decorate||function(decorators,target,key,desc){var c=arguments.length,r=c<3?target:desc===null?desc=Object.getOwnPropertyDescriptor(target,key):desc,d;if((typeof Reflect==="undefined"?"undefined":_typeof(Reflect))==="object"&&typeof Reflect.decorate==="function")r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--){if(d=decorators[i])r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r}return c>3&&r&&Object.defineProperty(target,key,r),r};var __metadata=void 0&&(void 0).__metadata||function(k,v){if((typeof Reflect==="undefined"?"undefined":_typeof(Reflect))==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(k,v)};Object.defineProperty(exports,"__esModule",{value:true});var persistent_typescript_1=require("persistent-typescript");var ConfigProfile=function(){function ConfigProfile(){this._apiKey="";this._profileId=""}Object.defineProperty(ConfigProfile.prototype,"apiKey",{get:function get(){return this._apiKey},set:function set(key){this._apiKey=key},enumerable:true,configurable:true});Object.defineProperty(ConfigProfile.prototype,"profileId",{get:function get(){return this._profileId},set:function set(profileId){this._profileId=profileId},enumerable:true,configurable:true});ConfigProfile=__decorate([persistent_typescript_1.Persistent(),__metadata("design:paramtypes",[])],ConfigProfile);return ConfigProfile}();exports.ConfigProfile=ConfigProfile},{"persistent-typescript":16}],2:[function(require,module,exports){"use strict";var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=void 0&&(void 0).__generator||function(thisArg,body){var _={label:0,sent:function sent(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_){try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var ConfigProfile_1=require("./ConfigProfile");var Network_1=require("./network/Network");var EventListener_1=require("./event/EventListener");var Storage_1=require("./storage/Storage");var FalconEye=function(){function FalconEye(apiKey,address){this.apiKey=apiKey;this.hasStarted=false;this.eventListener=new EventListener_1["default"](this);this.config=new ConfigProfile_1.ConfigProfile;this.network=new Network_1["default"](this,address);this.storage=new Storage_1.Storage(this)}FalconEye.prototype.observe=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:if(this.hasStarted)return[2];if(!(this.config.apiKey!=this.apiKey||this.config.profileId.length===0))return[3,2];this.config.apiKey=this.apiKey;this.config.profileId="";return[4,this.network.handshake()];case 1:if(_a.sent()==false){this.config.apiKey="";return[2]}_a.label=2;case 2:this.eventListener.listen();this.hasStarted=true;return[2]}})})};FalconEye.prototype.getConfig=function(){return this.config};FalconEye.prototype.getNetwork=function(){return this.network};FalconEye.prototype.getStorage=function(){return this.storage};return FalconEye}();exports.FalconEye=FalconEye;var fe=new FalconEye("KEY","http://localhost:3000/");fe.observe();var ua=window.navigator.userAgent;console.log(ua)},{"./ConfigProfile":1,"./event/EventListener":4,"./network/Network":10,"./storage/Storage":11}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Error=function(){function Error(){}Error.generateFromCode=function(code){if(this.errorList.hasOwnProperty(code))return"[FalconEye] "+this.errorList[code];return""};Error.errorList={"00":"No Error","01":"Invalid API Key","02":"Authentification failed"};return Error}();exports.Error=Error},{}],4:[function(require,module,exports){"use strict";var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=void 0&&(void 0).__generator||function(thisArg,body){var _={label:0,sent:function sent(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_){try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var FalconButtonEvent_1=require("./FalconButtonEvent");var FalconWheelEvent_1=require("./FalconWheelEvent");var FalconKeyboardEvent_1=require("./FalconKeyboardEvent");var KeyStatus_1=require("./KeyStatus");var EventListener=function(){function EventListener(fe){this.falconEye=fe}EventListener.prototype.listen=function(){this.listenClickEvent();this.listenWheelEvent();this.listenKeyboardEvent()};EventListener.prototype.listenClickEvent=function(){return __awaiter(this,void 0,void 0,function(){var _this=this;return __generator(this,function(_a){window.addEventListener("click",function(ev){var be=new FalconButtonEvent_1["default"](ev.screenX,ev.screenY,ev.clientX,ev.clientY,ev.button);console.table(be);_this.falconEye.getStorage().storeEvent(be)});return[2]})})};EventListener.prototype.listenWheelEvent=function(){return __awaiter(this,void 0,void 0,function(){var _this=this;return __generator(this,function(_a){window.addEventListener("wheel",function(ev){var me=new FalconWheelEvent_1["default"](ev.screenX,ev.screenY,ev.clientX,ev.clientY,ev.button,ev.deltaMode,ev.deltaX,ev.deltaY,ev.deltaZ);console.table(me);_this.falconEye.getStorage().storeEvent(me)});return[2]})})};EventListener.prototype.listenKeyboardEvent=function(){return __awaiter(this,void 0,void 0,function(){var _this=this;return __generator(this,function(_a){window.addEventListener("keyup",function(ev){var ke=new FalconKeyboardEvent_1["default"](ev.key,ev.code,KeyStatus_1.KeyStatus.KEYUP);console.table(ke);_this.falconEye.getStorage().storeEvent(ke)});window.addEventListener("keydown",function(ev){var ke=new FalconKeyboardEvent_1["default"](ev.key,ev.code,KeyStatus_1.KeyStatus.KEYDOWN);console.table(ke);_this.falconEye.getStorage().storeEvent(ke)});return[2]})})};return EventListener}();exports["default"]=EventListener},{"./FalconButtonEvent":5,"./FalconKeyboardEvent":7,"./FalconWheelEvent":8,"./KeyStatus":9}],5:[function(require,module,exports){"use strict";var __extends=void 0&&(void 0).__extends||function(){var _extendStatics=function extendStatics(d,b){_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b){if(b.hasOwnProperty(p))d[p]=b[p]}};return _extendStatics(d,b)};return function(d,b){_extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var FalconEvent_1=require("./FalconEvent");var FalconButtonEvent=function(_super){__extends(FalconButtonEvent,_super);function FalconButtonEvent(screenX,screenY,x,y,buttonType){var _this=_super.call(this)||this;_this.screenX=screenX;_this.screenY=screenY;_this.x=x;_this.y=y;_this.buttonType=buttonType;return _this}FalconButtonEvent.prototype.getScreenX=function(){return this.screenX};FalconButtonEvent.prototype.getScreenY=function(){return this.screenY};FalconButtonEvent.prototype.getX=function(){return this.x};FalconButtonEvent.prototype.getY=function(){return this.y};FalconButtonEvent.prototype.getButtonType=function(){return this.buttonType};return FalconButtonEvent}(FalconEvent_1["default"]);exports["default"]=FalconButtonEvent},{"./FalconEvent":6}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var FalconEvent=function(){function FalconEvent(){this.maxScreenX=screen.width;this.maxScreenY=screen.height;this.maxX=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;this.maxY=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;this.currentPath=window.location.pathname;this.date=new Date}FalconEvent.prototype.getMaxScreenX=function(){return this.maxScreenX};FalconEvent.prototype.getMaxScreenY=function(){return this.maxScreenY};FalconEvent.prototype.getMaxX=function(){return this.maxX};FalconEvent.prototype.getMaxY=function(){return this.maxY};FalconEvent.prototype.getCurrentPath=function(){return this.currentPath};FalconEvent.prototype.getDate=function(){return this.date};return FalconEvent}();exports["default"]=FalconEvent},{}],7:[function(require,module,exports){"use strict";var __extends=void 0&&(void 0).__extends||function(){var _extendStatics=function extendStatics(d,b){_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b){if(b.hasOwnProperty(p))d[p]=b[p]}};return _extendStatics(d,b)};return function(d,b){_extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var FalconEvent_1=require("./FalconEvent");var FalconKeyboardEvent=function(_super){__extends(FalconKeyboardEvent,_super);function FalconKeyboardEvent(key,keycode,keystatus){var _this=_super.call(this)||this;_this.key=key;_this.keycode=keycode;_this.keystatus=keystatus;return _this}FalconKeyboardEvent.prototype.getKey=function(){return this.key};FalconKeyboardEvent.prototype.getKeyCode=function(){return this.keycode};FalconKeyboardEvent.prototype.getKeyStatus=function(){return this.keystatus};return FalconKeyboardEvent}(FalconEvent_1["default"]);exports["default"]=FalconKeyboardEvent},{"./FalconEvent":6}],8:[function(require,module,exports){"use strict";var __extends=void 0&&(void 0).__extends||function(){var _extendStatics=function extendStatics(d,b){_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b){if(b.hasOwnProperty(p))d[p]=b[p]}};return _extendStatics(d,b)};return function(d,b){_extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var FalconButtonEvent_1=require("./FalconButtonEvent");var FalconWheelEvent=function(_super){__extends(FalconWheelEvent,_super);function FalconWheelEvent(screenX,screenY,x,y,buttonType,deltaMode,deltaX,deltaY,deltaZ){var _this=_super.call(this,screenX,screenY,x,y,buttonType)||this;_this.deltaMode=deltaMode;_this.deltaX=deltaX;_this.deltaY=deltaY;_this.deltaZ=deltaZ;return _this}FalconWheelEvent.prototype.getDeltaMode=function(){return this.deltaMode};FalconWheelEvent.prototype.getDeltaX=function(){return this.deltaX};FalconWheelEvent.prototype.getDeltaY=function(){return this.deltaY};FalconWheelEvent.prototype.getDeltaZ=function(){return this.deltaZ};return FalconWheelEvent}(FalconButtonEvent_1["default"]);exports["default"]=FalconWheelEvent},{"./FalconButtonEvent":5}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var KeyStatus;(function(KeyStatus){KeyStatus[KeyStatus["KEYDOWN"]=0]="KEYDOWN";KeyStatus[KeyStatus["KEYPRESS"]=1]="KEYPRESS";KeyStatus[KeyStatus["KEYUP"]=2]="KEYUP"})(KeyStatus=exports.KeyStatus||(exports.KeyStatus={}))},{}],10:[function(require,module,exports){"use strict";var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=void 0&&(void 0).__generator||function(thisArg,body){var _={label:0,sent:function sent(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_){try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var Error_1=require("../error/Error");var superagent=require("superagent");var Network=function(){function Network(falconEye,address){this.falconEye=falconEye;this.address=address+(address.slice(-1)==="/"?"":"/")}Network.prototype.handshake=function(){return __awaiter(this,void 0,void 0,function(){var _this=this;return __generator(this,function(_a){return[2,superagent.post(this.address+"connect/").send({apiKey:this.falconEye.getConfig().apiKey}).set("accept","json").then(function(res){var parsedBody=res.body;var code=parsedBody.code;if(code==="00"){_this.falconEye.getConfig().profileId=parsedBody.data.session;return true}console.log(Error_1.Error.generateFromCode(code));return false})["catch"](function(err){console.error("[FalconEye] Failed to handshake the server ! "+err);return false})]})})};Network.prototype.sendEvents=function(eventArray){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,superagent.post(this.address+"event/").send({apiKey:this.falconEye.getConfig().apiKey}).set("accept","json").set("authorization",this.falconEye.getConfig().profileId).then(function(res){var parsedBody=res.body;var code=parsedBody.code;if(code==="00")return true;console.log(Error_1.Error.generateFromCode(code));return false})["catch"](function(err){console.error("[FalconEye] Failed to send the events to the server ! "+err);return false})]})})};return Network}();exports["default"]=Network},{"../error/Error":3,superagent:24}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var FalconButtonEvent_1=require("../event/FalconButtonEvent");var FalconWheelEvent_1=require("../event/FalconWheelEvent");var FalconKeyboardEvent_1=require("../event/FalconKeyboardEvent");var Storage=function(){function Storage(falconEye){this.falconEye=falconEye;this.packets=[]}Storage.prototype.storeEvent=function(event){if(this.packets.length>=5){this.falconEye.getNetwork().sendEvents(this.packets);this.packets=[]}if(event instanceof FalconWheelEvent_1["default"]){this.packets.push({type:"wheel",data:event})}else if(event instanceof FalconButtonEvent_1["default"]){this.packets.push({type:"button",data:event})}else if(event instanceof FalconKeyboardEvent_1["default"]){this.packets.push({type:"keyboard",data:event})}};return Storage}();exports.Storage=Storage},{"../event/FalconButtonEvent":5,"../event/FalconKeyboardEvent":7,"../event/FalconWheelEvent":8}],12:[function(require,module,exports){},{}],13:[function(require,module,exports){if(typeof module!=="undefined"){module.exports=Emitter}function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key]}return obj}Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks["$"+event]=this._callbacks["$"+event]||[]).push(fn);return this};Emitter.prototype.once=function(event,fn){function on(){this.off(event,on);fn.apply(this,arguments)}on.fn=fn;this.on(event,on);return this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var callbacks=this._callbacks["$"+event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks["$"+event];return this}var cb;for(var i=0;i<callbacks.length;i++){cb=callbacks[i];if(cb===fn||cb.fn===fn){callbacks.splice(i,1);break}}if(callbacks.length===0){delete this._callbacks["$"+event]}return this};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=new Array(arguments.length-1),callbacks=this._callbacks["$"+event];for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args)}}return this};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks["$"+event]||[]};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},{}],14:[function(require,module,exports){module.exports=stringify;stringify.default=stringify;stringify.stable=deterministicStringify;stringify.stableStringify=deterministicStringify;var arr=[];function stringify(obj,replacer,spacer){decirc(obj,"",[],undefined);var res=JSON.stringify(obj,replacer,spacer);while(arr.length!==0){var part=arr.pop();part[0][part[1]]=part[2]}return res}function decirc(val,k,stack,parent){var i;if(typeof val==="object"&&val!==null){for(i=0;i<stack.length;i++){if(stack[i]===val){parent[k]="[Circular]";arr.push([parent,k,val]);return}}stack.push(val);if(Array.isArray(val)){for(i=0;i<val.length;i++){decirc(val[i],i,stack,val)}}else{var keys=Object.keys(val);for(i=0;i<keys.length;i++){var key=keys[i];decirc(val[key],key,stack,val)}}stack.pop()}}function compareFunction(a,b){if(a<b){return-1}if(a>b){return 1}return 0}function deterministicStringify(obj,replacer,spacer){var tmp=deterministicDecirc(obj,"",[],undefined)||obj;var res=JSON.stringify(tmp,replacer,spacer);while(arr.length!==0){var part=arr.pop();part[0][part[1]]=part[2]}return res}function deterministicDecirc(val,k,stack,parent){var i;if(typeof val==="object"&&val!==null){for(i=0;i<stack.length;i++){if(stack[i]===val){parent[k]="[Circular]";arr.push([parent,k,val]);return}}if(typeof val.toJSON==="function"){return}stack.push(val);if(Array.isArray(val)){for(i=0;i<val.length;i++){deterministicDecirc(val[i],i,stack,val)}}else{var tmp={};var keys=Object.keys(val).sort(compareFunction);for(i=0;i<keys.length;i++){var key=keys[i];deterministicDecirc(val[key],key,stack,val);tmp[key]=val[key]}if(parent!==undefined){arr.push([parent,k,val]);parent[k]=tmp}else{return tmp}}stack.pop()}}},{}],15:[function(require,module,exports){(function(process){function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==="."){parts.splice(i,1)}else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift("..")}}return parts}exports.resolve=function(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(typeof path!=="string"){throw new TypeError("Arguments to path.resolve must be strings")}else if(!path){continue}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."};exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash=substr(path,-1)==="/";path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/");if(!path&&!isAbsolute){path="."}if(path&&trailingSlash){path+="/"}return(isAbsolute?"/":"")+path};exports.isAbsolute=function(path){return path.charAt(0)==="/"};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){if(typeof p!=="string"){throw new TypeError("Arguments to path.join must be strings")}return p}).join("/"))};exports.relative=function(from,to){from=exports.resolve(from).substr(1);to=exports.resolve(to).substr(1);function trim(arr){var start=0;for(;start<arr.length;start++){if(arr[start]!=="")break}var end=arr.length-1;for(;end>=0;end--){if(arr[end]!=="")break}if(start>end)return[];return arr.slice(start,end-start+1)}var fromParts=trim(from.split("/"));var toParts=trim(to.split("/"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break}}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++){outputParts.push("..")}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join("/")};exports.sep="/";exports.delimiter=":";exports.dirname=function(path){if(typeof path!=="string")path=path+"";if(path.length===0)return".";var code=path.charCodeAt(0);var hasRoot=code===47;var end=-1;var matchedSlash=true;for(var i=path.length-1;i>=1;--i){code=path.charCodeAt(i);if(code===47){if(!matchedSlash){end=i;break}}else{matchedSlash=false}}if(end===-1)return hasRoot?"/":".";if(hasRoot&&end===1){return"/"}return path.slice(0,end)};function basename(path){if(typeof path!=="string")path=path+"";var start=0;var end=-1;var matchedSlash=true;var i;for(i=path.length-1;i>=0;--i){if(path.charCodeAt(i)===47){if(!matchedSlash){start=i+1;break}}else if(end===-1){matchedSlash=false;end=i+1}}if(end===-1)return"";return path.slice(start,end)}exports.basename=function(path,ext){var f=basename(path);if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length)}return f};exports.extname=function(path){if(typeof path!=="string")path=path+"";var startDot=-1;var startPart=0;var end=-1;var matchedSlash=true;var preDotState=0;for(var i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(code===47){if(!matchedSlash){startPart=i+1;break}continue}if(end===-1){matchedSlash=false;end=i+1}if(code===46){if(startDot===-1)startDot=i;else if(preDotState!==1)preDotState=1}else if(startDot!==-1){preDotState=-1}}if(startDot===-1||end===-1||preDotState===0||preDotState===1&&startDot===end-1&&startDot===startPart+1){return""}return path.slice(startDot,end)};function filter(xs,f){if(xs.filter)return xs.filter(f);var res=[];for(var i=0;i<xs.length;i++){if(f(xs[i],i,xs))res.push(xs[i])}return res}var substr="ab".substr(-1)==="b"?function(str,start,len){return str.substr(start,len)}:function(str,start,len){if(start<0)start=str.length+start;return str.substr(start,len)}}).call(this,require("_process"))},{_process:21}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});require("reflect-metadata");var Storage_1=require("./Storage");var JsonPlugin_1=require("./plugin/JsonPlugin");var Utils_1=require("./utils/Utils");function defaultOptions(){return{plugin:new JsonPlugin_1.JsonPlugin(false),path:".persistent.json",debug:false}}function Persistent(options){if(options===void 0){options=defaultOptions()}return function(target){var original=target;function construct(constructor){var args=[];for(var _i=1;_i<arguments.length;_i++){args[_i-1]=arguments[_i]}var c=function(){return constructor.apply(this,args)};c.prototype=constructor.prototype;return new c}var f=function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}var instance=construct(original,args);var className=Utils_1.Utils.getClassName(instance);if(className!=null){var classLoaded=Storage_1.storage.getInstanceOfClass(className,options);if(classLoaded!=null)return classLoaded}Storage_1.storage.store(instance,options);return instance};f.prototype=original.prototype;return f}}exports.Persistent=Persistent},{"./Storage":17,"./plugin/JsonPlugin":18,"./utils/Utils":20,"reflect-metadata":22}],17:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utils_1=require("./utils/Utils");var Map_1=require("./utils/Map");var fs=require("fs");var process=require("process");var path=require("path");var Storage=function(){function Storage(){var This=this;this.persistentObjects=new Map_1.Map;this.persistentObjectsMetadata=new Map_1.Map;if(Utils_1.Utils.isBrowser()){window.addEventListener("unload",function(event){This.save()})}else{process.on("SIGINT",function(){This.save();process.exit()});process.on("SIGHUP",function(){This.save();process.exit()});process.on("SIGQUIT",function(){This.save();process.exit()});process.on("SIGTERM",function(){This.save();process.exit()});process.on("uncaughtException",function(){This.save();process.exit()});process.on("exit",function(){This.save();process.exit()})}}Storage.prototype.loadPersistentFile=function(options,force){try{var filePath=path.resolve(options.path);var data=void 0;if(this.persistentObjects.containsKey(filePath)==true&&!force)return;this.persistentObjects.put(filePath,options.plugin.init());this.persistentObjectsMetadata.put(filePath,options);if(Utils_1.Utils.isBrowser())data=localStorage.getItem(filePath);else data=fs.readFileSync(filePath,"utf8");if(data==null)return;this.persistentObjects.put(filePath,options.plugin.deserialize(data));this.persistentObjectsMetadata.put(filePath,options)}catch(err){if(options.debug){console.log("Failed to load the persistent file '"+options.path+"'");console.log("Error: "+err)}}};Storage.prototype.store=function(classInstance,options){this.loadPersistentFile(options,false);var className=Utils_1.Utils.getClassName(classInstance);var filePath=path.resolve(options.path);if(className==null)return;var savedClass=options.plugin.get(this.persistentObjects.getValue(filePath),className);if(savedClass!=null){for(var field in savedClass){classInstance[field]=savedClass[field]}}options.plugin.put(this.persistentObjects.getValue(filePath),className,classInstance)};Storage.prototype.getInstanceOfClass=function(className,options){var savedClass=options.plugin.get(this.persistentObjects.getValue(path.resolve(options.path)),className);return savedClass};Storage.prototype.save=function(){var option;var instance;for(var _i=0,_a=this.persistentObjects.keys();_i<_a.length;_i++){var key=_a[_i];option=this.persistentObjectsMetadata.getValue(key);instance=this.persistentObjects.getValue(key);if(option.debug)console.log("Trying to save the instance of the object '"+Utils_1.Utils.getClassName(instance)+"' to the path '"+key+"'");if(Utils_1.Utils.isBrowser())localStorage.setItem(key,option.plugin.serialize(instance));else fs.writeFileSync(key,option.plugin.serialize(instance));if(option.debug)console.log("The instance of the object '"+Utils_1.Utils.getClassName(instance)+"' has been saved to the path '"+key+"'")}};Storage.prototype.getSize=function(){return this.persistentObjects.size()};return Storage}();exports.Storage=Storage;if(exports.storage==undefined){exports.storage=new Storage}},{"./utils/Map":19,"./utils/Utils":20,fs:12,path:15,process:21}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Map_1=require("../utils/Map");var Utils_1=require("../utils/Utils");var JsonPlugin=function(){function JsonPlugin(isMinified){this.minified=isMinified}JsonPlugin.prototype.init=function(){return new Map_1.Map};JsonPlugin.prototype.serialize=function(object){if(Utils_1.Utils.isBrowser())return object.toJson(true);return object.toJson(this.minified)};JsonPlugin.prototype.deserialize=function(serializedObject){return Map_1.Map.fromJson(serializedObject)};JsonPlugin.prototype.get=function(object,className){if(object==null)return null;return object.getValue(className)};JsonPlugin.prototype.put=function(object,className,classInstance){object.put(className,classInstance)};return JsonPlugin}();exports.JsonPlugin=JsonPlugin},{"../utils/Map":19,"../utils/Utils":20}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Map=function(){function Map(){this.map={};this.mapSize=0}Map.prototype.put=function(key,value){if(!this.containsKey(key)){this.mapSize++}this.map[key]=value;return true};Map.prototype.clear=function(){this.mapSize=0;this.map={};return true};Map.prototype.keys=function(){var keys=[];for(var key in this.map){if(this.map.hasOwnProperty(key)){keys.push(key)}}return keys};Map.prototype.values=function(){var values=[];for(var key in this.map){if(this.map.hasOwnProperty(key)){values.push(this.map[key])}}return values};Map.prototype.isEmpty=function(){return this.mapSize===0};Map.prototype.removeKey=function(key){if(this.containsKey(key)){this.mapSize--;var value=this.map[key];delete this.map[key];return value}return null};Map.prototype.containsKey=function(key){return this.map.hasOwnProperty(key)};Map.prototype.containsValue=function(value){for(var key in this.map){if(this.map.hasOwnProperty(key)){if(this.map[key]===value){return true}}}return false};Map.prototype.size=function(){return this.mapSize};Map.prototype.getValue=function(key){if(this.containsKey(key)){return this.map[key]}return null};Map.prototype.toJson=function(isMinified){if(!isMinified)return JSON.stringify(this.map,null,4);else return JSON.stringify(this.map)};Map.fromJson=function(serializedHm){var hm=new Map;var rawObject=JSON.parse(serializedHm);if(rawObject==null)return null;for(var key in rawObject){hm.put(key,rawObject[key])}return hm};return Map}();exports.Map=Map},{}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utils=function(){function Utils(){}Utils.getClassName=function(instance){return instance.constructor?instance.constructor.name:null};Utils.isBrowser=function(){return typeof window!=="undefined"&&typeof window.document!=="undefined"};return Utils}();exports.Utils=Utils},{}],21:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],22:[function(require,module,exports){(function(process,global){var Reflect;(function(Reflect){(function(factory){var root=typeof global==="object"?global:typeof self==="object"?self:typeof this==="object"?this:Function("return this;")();var exporter=makeExporter(Reflect);if(typeof root.Reflect==="undefined"){root.Reflect=Reflect}else{exporter=makeExporter(root.Reflect,exporter)}factory(exporter);function makeExporter(target,previous){return function(key,value){if(typeof target[key]!=="function"){Object.defineProperty(target,key,{configurable:true,writable:true,value:value})}if(previous)previous(key,value)}}})(function(exporter){var hasOwn=Object.prototype.hasOwnProperty;var supportsSymbol=typeof Symbol==="function";var toPrimitiveSymbol=supportsSymbol&&typeof Symbol.toPrimitive!=="undefined"?Symbol.toPrimitive:"@@toPrimitive";var iteratorSymbol=supportsSymbol&&typeof Symbol.iterator!=="undefined"?Symbol.iterator:"@@iterator";var supportsCreate=typeof Object.create==="function";var supportsProto={__proto__:[]}instanceof Array;var downLevel=!supportsCreate&&!supportsProto;var HashMap={create:supportsCreate?function(){return MakeDictionary(Object.create(null))}:supportsProto?function(){return MakeDictionary({__proto__:null})}:function(){return MakeDictionary({})},has:downLevel?function(map,key){return hasOwn.call(map,key)}:function(map,key){return key in map},get:downLevel?function(map,key){return hasOwn.call(map,key)?map[key]:undefined}:function(map,key){return map[key]}};var functionPrototype=Object.getPrototypeOf(Function);var usePolyfill=typeof process==="object"&&process.env&&process.env["REFLECT_METADATA_USE_MAP_POLYFILL"]==="true";var _Map=!usePolyfill&&typeof Map==="function"&&typeof Map.prototype.entries==="function"?Map:CreateMapPolyfill();var _Set=!usePolyfill&&typeof Set==="function"&&typeof Set.prototype.entries==="function"?Set:CreateSetPolyfill();var _WeakMap=!usePolyfill&&typeof WeakMap==="function"?WeakMap:CreateWeakMapPolyfill();var Metadata=new _WeakMap;function decorate(decorators,target,propertyKey,attributes){if(!IsUndefined(propertyKey)){if(!IsArray(decorators))throw new TypeError;if(!IsObject(target))throw new TypeError;if(!IsObject(attributes)&&!IsUndefined(attributes)&&!IsNull(attributes))throw new TypeError;if(IsNull(attributes))attributes=undefined;propertyKey=ToPropertyKey(propertyKey);return DecorateProperty(decorators,target,propertyKey,attributes)}else{if(!IsArray(decorators))throw new TypeError;if(!IsConstructor(target))throw new TypeError;return DecorateConstructor(decorators,target)}}exporter("decorate",decorate);function metadata(metadataKey,metadataValue){function decorator(target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey)&&!IsPropertyKey(propertyKey))throw new TypeError;OrdinaryDefineOwnMetadata(metadataKey,metadataValue,target,propertyKey)}return decorator}exporter("metadata",metadata);function defineMetadata(metadataKey,metadataValue,target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryDefineOwnMetadata(metadataKey,metadataValue,target,propertyKey)}exporter("defineMetadata",defineMetadata);function hasMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryHasMetadata(metadataKey,target,propertyKey)}exporter("hasMetadata",hasMetadata);function hasOwnMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryHasOwnMetadata(metadataKey,target,propertyKey)}exporter("hasOwnMetadata",hasOwnMetadata);function getMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryGetMetadata(metadataKey,target,propertyKey)}exporter("getMetadata",getMetadata);function getOwnMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryGetOwnMetadata(metadataKey,target,propertyKey)}exporter("getOwnMetadata",getOwnMetadata);function getMetadataKeys(target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryMetadataKeys(target,propertyKey)}exporter("getMetadataKeys",getMetadataKeys);function getOwnMetadataKeys(target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryOwnMetadataKeys(target,propertyKey)}exporter("getOwnMetadataKeys",getOwnMetadataKeys);function deleteMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);var metadataMap=GetOrCreateMetadataMap(target,propertyKey,false);if(IsUndefined(metadataMap))return false;if(!metadataMap.delete(metadataKey))return false;if(metadataMap.size>0)return true;var targetMetadata=Metadata.get(target);targetMetadata.delete(propertyKey);if(targetMetadata.size>0)return true;Metadata.delete(target);return true}exporter("deleteMetadata",deleteMetadata);function DecorateConstructor(decorators,target){for(var i=decorators.length-1;i>=0;--i){var decorator=decorators[i];var decorated=decorator(target);if(!IsUndefined(decorated)&&!IsNull(decorated)){if(!IsConstructor(decorated))throw new TypeError;target=decorated}}return target}function DecorateProperty(decorators,target,propertyKey,descriptor){for(var i=decorators.length-1;i>=0;--i){var decorator=decorators[i];var decorated=decorator(target,propertyKey,descriptor);if(!IsUndefined(decorated)&&!IsNull(decorated)){if(!IsObject(decorated))throw new TypeError;descriptor=decorated}}return descriptor}function GetOrCreateMetadataMap(O,P,Create){var targetMetadata=Metadata.get(O);if(IsUndefined(targetMetadata)){if(!Create)return undefined;targetMetadata=new _Map;Metadata.set(O,targetMetadata)}var metadataMap=targetMetadata.get(P);if(IsUndefined(metadataMap)){if(!Create)return undefined;metadataMap=new _Map;targetMetadata.set(P,metadataMap)}return metadataMap}function OrdinaryHasMetadata(MetadataKey,O,P){var hasOwn=OrdinaryHasOwnMetadata(MetadataKey,O,P);if(hasOwn)return true;var parent=OrdinaryGetPrototypeOf(O);if(!IsNull(parent))return OrdinaryHasMetadata(MetadataKey,parent,P);return false}function OrdinaryHasOwnMetadata(MetadataKey,O,P){var metadataMap=GetOrCreateMetadataMap(O,P,false);if(IsUndefined(metadataMap))return false;return ToBoolean(metadataMap.has(MetadataKey))}function OrdinaryGetMetadata(MetadataKey,O,P){var hasOwn=OrdinaryHasOwnMetadata(MetadataKey,O,P);if(hasOwn)return OrdinaryGetOwnMetadata(MetadataKey,O,P);var parent=OrdinaryGetPrototypeOf(O);if(!IsNull(parent))return OrdinaryGetMetadata(MetadataKey,parent,P);return undefined}function OrdinaryGetOwnMetadata(MetadataKey,O,P){var metadataMap=GetOrCreateMetadataMap(O,P,false);if(IsUndefined(metadataMap))return undefined;return metadataMap.get(MetadataKey)}function OrdinaryDefineOwnMetadata(MetadataKey,MetadataValue,O,P){var metadataMap=GetOrCreateMetadataMap(O,P,true);metadataMap.set(MetadataKey,MetadataValue)}function OrdinaryMetadataKeys(O,P){var ownKeys=OrdinaryOwnMetadataKeys(O,P);var parent=OrdinaryGetPrototypeOf(O);if(parent===null)return ownKeys;var parentKeys=OrdinaryMetadataKeys(parent,P);if(parentKeys.length<=0)return ownKeys;if(ownKeys.length<=0)return parentKeys;var set=new _Set;var keys=[];for(var _i=0,ownKeys_1=ownKeys;_i<ownKeys_1.length;_i++){var key=ownKeys_1[_i];var hasKey=set.has(key);if(!hasKey){set.add(key);keys.push(key)}}for(var _a=0,parentKeys_1=parentKeys;_a<parentKeys_1.length;_a++){var key=parentKeys_1[_a];var hasKey=set.has(key);if(!hasKey){set.add(key);keys.push(key)}}return keys}function OrdinaryOwnMetadataKeys(O,P){var keys=[];var metadataMap=GetOrCreateMetadataMap(O,P,false);if(IsUndefined(metadataMap))return keys;var keysObj=metadataMap.keys();var iterator=GetIterator(keysObj);var k=0;while(true){var next=IteratorStep(iterator);if(!next){keys.length=k;return keys}var nextValue=IteratorValue(next);try{keys[k]=nextValue}catch(e){try{IteratorClose(iterator)}finally{throw e}}k++}}function Type(x){if(x===null)return 1;switch(typeof x){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return x===null?1:6;default:return 6}}function IsUndefined(x){return x===undefined}function IsNull(x){return x===null}function IsSymbol(x){return typeof x==="symbol"}function IsObject(x){return typeof x==="object"?x!==null:typeof x==="function"}function ToPrimitive(input,PreferredType){switch(Type(input)){case 0:return input;case 1:return input;case 2:return input;case 3:return input;case 4:return input;case 5:return input}var hint=PreferredType===3?"string":PreferredType===5?"number":"default";var exoticToPrim=GetMethod(input,toPrimitiveSymbol);if(exoticToPrim!==undefined){var result=exoticToPrim.call(input,hint);if(IsObject(result))throw new TypeError;return result}return OrdinaryToPrimitive(input,hint==="default"?"number":hint)}function OrdinaryToPrimitive(O,hint){if(hint==="string"){var toString_1=O.toString;if(IsCallable(toString_1)){var result=toString_1.call(O);if(!IsObject(result))return result}var valueOf=O.valueOf;if(IsCallable(valueOf)){var result=valueOf.call(O);if(!IsObject(result))return result}}else{var valueOf=O.valueOf;if(IsCallable(valueOf)){var result=valueOf.call(O);if(!IsObject(result))return result}var toString_2=O.toString;if(IsCallable(toString_2)){var result=toString_2.call(O);if(!IsObject(result))return result}}throw new TypeError}function ToBoolean(argument){return!!argument}function ToString(argument){return""+argument}function ToPropertyKey(argument){var key=ToPrimitive(argument,3);if(IsSymbol(key))return key;return ToString(key)}function IsArray(argument){return Array.isArray?Array.isArray(argument):argument instanceof Object?argument instanceof Array:Object.prototype.toString.call(argument)==="[object Array]"}function IsCallable(argument){return typeof argument==="function"}function IsConstructor(argument){return typeof argument==="function"}function IsPropertyKey(argument){switch(Type(argument)){case 3:return true;case 4:return true;default:return false}}function GetMethod(V,P){var func=V[P];if(func===undefined||func===null)return undefined;if(!IsCallable(func))throw new TypeError;return func}function GetIterator(obj){var method=GetMethod(obj,iteratorSymbol);if(!IsCallable(method))throw new TypeError;var iterator=method.call(obj);if(!IsObject(iterator))throw new TypeError;return iterator}function IteratorValue(iterResult){return iterResult.value}function IteratorStep(iterator){var result=iterator.next();return result.done?false:result}function IteratorClose(iterator){var f=iterator["return"];if(f)f.call(iterator)}function OrdinaryGetPrototypeOf(O){var proto=Object.getPrototypeOf(O);if(typeof O!=="function"||O===functionPrototype)return proto;if(proto!==functionPrototype)return proto;var prototype=O.prototype;var prototypeProto=prototype&&Object.getPrototypeOf(prototype);if(prototypeProto==null||prototypeProto===Object.prototype)return proto;var constructor=prototypeProto.constructor;if(typeof constructor!=="function")return proto;if(constructor===O)return proto;return constructor}function CreateMapPolyfill(){var cacheSentinel={};var arraySentinel=[];var MapIterator=function(){function MapIterator(keys,values,selector){this._index=0;this._keys=keys;this._values=values;this._selector=selector}MapIterator.prototype["@@iterator"]=function(){return this};MapIterator.prototype[iteratorSymbol]=function(){return this};MapIterator.prototype.next=function(){var index=this._index;if(index>=0&&index<this._keys.length){var result=this._selector(this._keys[index],this._values[index]);if(index+1>=this._keys.length){this._index=-1;this._keys=arraySentinel;this._values=arraySentinel}else{this._index++}return{value:result,done:false}}return{value:undefined,done:true}};MapIterator.prototype.throw=function(error){if(this._index>=0){this._index=-1;this._keys=arraySentinel;this._values=arraySentinel}throw error};MapIterator.prototype.return=function(value){if(this._index>=0){this._index=-1;this._keys=arraySentinel;this._values=arraySentinel}return{value:value,done:true}};return MapIterator}();return function(){function Map(){this._keys=[];this._values=[];this._cacheKey=cacheSentinel;this._cacheIndex=-2}Object.defineProperty(Map.prototype,"size",{get:function(){return this._keys.length},enumerable:true,configurable:true});Map.prototype.has=function(key){return this._find(key,false)>=0};Map.prototype.get=function(key){var index=this._find(key,false);return index>=0?this._values[index]:undefined};Map.prototype.set=function(key,value){var index=this._find(key,true);this._values[index]=value;return this};Map.prototype.delete=function(key){var index=this._find(key,false);if(index>=0){var size=this._keys.length;for(var i=index+1;i<size;i++){this._keys[i-1]=this._keys[i];this._values[i-1]=this._values[i]}this._keys.length--;this._values.length--;if(key===this._cacheKey){this._cacheKey=cacheSentinel;this._cacheIndex=-2}return true}return false};Map.prototype.clear=function(){this._keys.length=0;this._values.length=0;this._cacheKey=cacheSentinel;this._cacheIndex=-2};Map.prototype.keys=function(){return new MapIterator(this._keys,this._values,getKey)};Map.prototype.values=function(){return new MapIterator(this._keys,this._values,getValue)};Map.prototype.entries=function(){return new MapIterator(this._keys,this._values,getEntry)};Map.prototype["@@iterator"]=function(){return this.entries()};Map.prototype[iteratorSymbol]=function(){return this.entries()};Map.prototype._find=function(key,insert){if(this._cacheKey!==key){this._cacheIndex=this._keys.indexOf(this._cacheKey=key)}if(this._cacheIndex<0&&insert){this._cacheIndex=this._keys.length;this._keys.push(key);this._values.push(undefined)}return this._cacheIndex};return Map}();function getKey(key,_){return key}function getValue(_,value){return value}function getEntry(key,value){return[key,value]}}function CreateSetPolyfill(){return function(){function Set(){this._map=new _Map}Object.defineProperty(Set.prototype,"size",{get:function(){return this._map.size},enumerable:true,configurable:true});Set.prototype.has=function(value){return this._map.has(value)};Set.prototype.add=function(value){return this._map.set(value,value),this};Set.prototype.delete=function(value){return this._map.delete(value)};Set.prototype.clear=function(){this._map.clear()};Set.prototype.keys=function(){return this._map.keys()};Set.prototype.values=function(){return this._map.values()};Set.prototype.entries=function(){return this._map.entries()};Set.prototype["@@iterator"]=function(){return this.keys()};Set.prototype[iteratorSymbol]=function(){return this.keys()};return Set}()}function CreateWeakMapPolyfill(){var UUID_SIZE=16;var keys=HashMap.create();var rootKey=CreateUniqueKey();return function(){function WeakMap(){this._key=CreateUniqueKey()}WeakMap.prototype.has=function(target){var table=GetOrCreateWeakMapTable(target,false);return table!==undefined?HashMap.has(table,this._key):false};WeakMap.prototype.get=function(target){var table=GetOrCreateWeakMapTable(target,false);return table!==undefined?HashMap.get(table,this._key):undefined};WeakMap.prototype.set=function(target,value){var table=GetOrCreateWeakMapTable(target,true);table[this._key]=value;return this};WeakMap.prototype.delete=function(target){var table=GetOrCreateWeakMapTable(target,false);return table!==undefined?delete table[this._key]:false};WeakMap.prototype.clear=function(){this._key=CreateUniqueKey()};return WeakMap}();function CreateUniqueKey(){var key;do{key="@@WeakMap@@"+CreateUUID()}while(HashMap.has(keys,key));keys[key]=true;return key}function GetOrCreateWeakMapTable(target,create){if(!hasOwn.call(target,rootKey)){if(!create)return undefined;Object.defineProperty(target,rootKey,{value:HashMap.create()})}return target[rootKey]}function FillRandomBytes(buffer,size){for(var i=0;i<size;++i)buffer[i]=Math.random()*255|0;return buffer}function GenRandomBytes(size){if(typeof Uint8Array==="function"){if(typeof crypto!=="undefined")return crypto.getRandomValues(new Uint8Array(size));if(typeof msCrypto!=="undefined")return msCrypto.getRandomValues(new Uint8Array(size));return FillRandomBytes(new Uint8Array(size),size)}return FillRandomBytes(new Array(size),size)}function CreateUUID(){var data=GenRandomBytes(UUID_SIZE);data[6]=data[6]&79|64;data[8]=data[8]&191|128;var result="";for(var offset=0;offset<UUID_SIZE;++offset){var byte=data[offset];if(offset===4||offset===6||offset===8)result+="-";if(byte<16)result+="0";result+=byte.toString(16).toLowerCase()}return result}}function MakeDictionary(obj){obj.__=undefined;delete obj.__;return obj}})})(Reflect||(Reflect={}))}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:21}],23:[function(require,module,exports){"use strict";function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function Agent(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(function(fn){Agent.prototype[fn]=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}this._defaults.push({fn:fn,args:args});return this}});Agent.prototype._setDefaults=function(req){this._defaults.forEach(function(def){req[def.fn].apply(req,_toConsumableArray(def.args))})};module.exports=Agent},{}],24:[function(require,module,exports){"use strict";function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}var root;if(typeof window!=="undefined"){root=window}else if(typeof self==="undefined"){console.warn("Using browser-only version of superagent in non-browser environment");root=void 0}else{root=self}var Emitter=require("component-emitter");var safeStringify=require("fast-safe-stringify");var RequestBase=require("./request-base");var isObject=require("./is-object");var ResponseBase=require("./response-base");var Agent=require("./agent-base");function noop(){}module.exports=function(method,url){if(typeof url==="function"){return new exports.Request("GET",method).end(url)}if(arguments.length===1){return new exports.Request("GET",method)}return new exports.Request(method,url)};exports=module.exports;var request=exports;exports.Request=Request;request.getXHR=function(){if(root.XMLHttpRequest&&(!root.location||root.location.protocol!=="file:"||!root.ActiveXObject)){return new XMLHttpRequest}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(err){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(err){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(err){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(err){}throw new Error("Browser-only version of superagent could not find XHR")};var trim="".trim?function(s){return s.trim()}:function(s){return s.replace(/(^\s*|\s*$)/g,"")};function serialize(obj){if(!isObject(obj))return obj;var pairs=[];for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))pushEncodedKeyValuePair(pairs,key,obj[key])}return pairs.join("&")}function pushEncodedKeyValuePair(pairs,key,val){if(val===undefined)return;if(val===null){pairs.push(encodeURIComponent(key));return}if(Array.isArray(val)){val.forEach(function(v){pushEncodedKeyValuePair(pairs,key,v)})}else if(isObject(val)){for(var subkey in val){if(Object.prototype.hasOwnProperty.call(val,subkey))pushEncodedKeyValuePair(pairs,"".concat(key,"[").concat(subkey,"]"),val[subkey])}}else{pairs.push(encodeURIComponent(key)+"="+encodeURIComponent(val))}}request.serializeObject=serialize;function parseString(str){var obj={};var pairs=str.split("&");var pair;var pos;for(var i=0,len=pairs.length;i<len;++i){pair=pairs[i];pos=pair.indexOf("=");if(pos===-1){obj[decodeURIComponent(pair)]=""}else{obj[decodeURIComponent(pair.slice(0,pos))]=decodeURIComponent(pair.slice(pos+1))}}return obj}request.parseString=parseString;request.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"};request.serialize={"application/x-www-form-urlencoded":serialize,"application/json":safeStringify};request.parse={"application/x-www-form-urlencoded":parseString,"application/json":JSON.parse};function parseHeader(str){var lines=str.split(/\r?\n/);var fields={};var index;var line;var field;var val;for(var i=0,len=lines.length;i<len;++i){line=lines[i];index=line.indexOf(":");if(index===-1){continue}field=line.slice(0,index).toLowerCase();val=trim(line.slice(index+1));fields[field]=val}return fields}function isJSON(mime){return/[/+]json($|[^-\w])/.test(mime)}function Response(req){this.req=req;this.xhr=this.req.xhr;this.text=this.req.method!=="HEAD"&&(this.xhr.responseType===""||this.xhr.responseType==="text")||typeof this.xhr.responseType==="undefined"?this.xhr.responseText:null;this.statusText=this.req.xhr.statusText;var status=this.xhr.status;if(status===1223){status=204}this._setStatusProperties(status);this.headers=parseHeader(this.xhr.getAllResponseHeaders());this.header=this.headers;this.header["content-type"]=this.xhr.getResponseHeader("content-type");this._setHeaderProperties(this.header);if(this.text===null&&req._responseType){this.body=this.xhr.response}else{this.body=this.req.method==="HEAD"?null:this._parseBody(this.text?this.text:this.xhr.response)}}ResponseBase(Response.prototype);Response.prototype._parseBody=function(str){var parse=request.parse[this.type];if(this.req._parser){return this.req._parser(this,str)}if(!parse&&isJSON(this.type)){parse=request.parse["application/json"]}return parse&&str&&(str.length>0||str instanceof Object)?parse(str):null};Response.prototype.toError=function(){var req=this.req;var method=req.method;var url=req.url;var msg="cannot ".concat(method," ").concat(url," (").concat(this.status,")");var err=new Error(msg);err.status=this.status;err.method=method;err.url=url;return err};request.Response=Response;function Request(method,url){var self=this;this._query=this._query||[];this.method=method;this.url=url;this.header={};this._header={};this.on("end",function(){var err=null;var res=null;try{res=new Response(self)}catch(err2){err=new Error("Parser is unable to parse the response");err.parse=true;err.original=err2;if(self.xhr){err.rawResponse=typeof self.xhr.responseType==="undefined"?self.xhr.responseText:self.xhr.response;err.status=self.xhr.status?self.xhr.status:null;err.statusCode=err.status}else{err.rawResponse=null;err.status=null}return self.callback(err)}self.emit("response",res);var new_err;try{if(!self._isResponseOK(res)){new_err=new Error(res.statusText||"Unsuccessful HTTP response")}}catch(err2){new_err=err2}if(new_err){new_err.original=err;new_err.response=res;new_err.status=res.status;self.callback(new_err,res)}else{self.callback(null,res)}})}Emitter(Request.prototype);RequestBase(Request.prototype);Request.prototype.type=function(type){this.set("Content-Type",request.types[type]||type);return this};Request.prototype.accept=function(type){this.set("Accept",request.types[type]||type);return this};Request.prototype.auth=function(user,pass,options){if(arguments.length===1)pass="";if(_typeof(pass)==="object"&&pass!==null){options=pass;pass=""}if(!options){options={type:typeof btoa==="function"?"basic":"auto"}}var encoder=function encoder(string){if(typeof btoa==="function"){return btoa(string)}throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(user,pass,options,encoder)};Request.prototype.query=function(val){if(typeof val!=="string")val=serialize(val);if(val)this._query.push(val);return this};Request.prototype.attach=function(field,file,options){if(file){if(this._data){throw new Error("superagent can't mix .send() and .attach()")}this._getFormData().append(field,file,options||file.name)}return this};Request.prototype._getFormData=function(){if(!this._formData){this._formData=new root.FormData}return this._formData};Request.prototype.callback=function(err,res){if(this._shouldRetry(err,res)){return this._retry()}var fn=this._callback;this.clearTimeout();if(err){if(this._maxRetries)err.retries=this._retries-1;this.emit("error",err)}fn(err,res)};Request.prototype.crossDomainError=function(){var err=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");err.crossDomain=true;err.status=this.status;err.method=this.method;err.url=this.url;this.callback(err)};Request.prototype.agent=function(){console.warn("This is not supported in browser version of superagent");return this};Request.prototype.buffer=Request.prototype.ca;Request.prototype.ca=Request.prototype.agent;Request.prototype.write=function(){throw new Error("Streaming is not supported in browser version of superagent")};Request.prototype.pipe=Request.prototype.write;Request.prototype._isHost=function(obj){return obj&&_typeof(obj)==="object"&&!Array.isArray(obj)&&Object.prototype.toString.call(obj)!=="[object Object]"};Request.prototype.end=function(fn){if(this._endCalled){console.warn("Warning: .end() was called twice. This is not supported in superagent")}this._endCalled=true;this._callback=fn||noop;this._finalizeQueryString();this._end()};Request.prototype._setUploadTimeout=function(){var self=this;if(this._uploadTimeout&&!this._uploadTimeoutTimer){this._uploadTimeoutTimer=setTimeout(function(){self._timeoutError("Upload timeout of ",self._uploadTimeout,"ETIMEDOUT")},this._uploadTimeout)}};Request.prototype._end=function(){if(this._aborted)return this.callback(new Error("The request has been aborted even before .end() was called"));var self=this;this.xhr=request.getXHR();var xhr=this.xhr;var data=this._formData||this._data;this._setTimeouts();xhr.onreadystatechange=function(){var readyState=xhr.readyState;if(readyState>=2&&self._responseTimeoutTimer){clearTimeout(self._responseTimeoutTimer)}if(readyState!==4){return}var status;try{status=xhr.status}catch(err){status=0}if(!status){if(self.timedout||self._aborted)return;return self.crossDomainError()}self.emit("end")};var handleProgress=function handleProgress(direction,e){if(e.total>0){e.percent=e.loaded/e.total*100;if(e.percent===100){clearTimeout(self._uploadTimeoutTimer)}}e.direction=direction;self.emit("progress",e)};if(this.hasListeners("progress")){try{xhr.addEventListener("progress",handleProgress.bind(null,"download"));if(xhr.upload){xhr.upload.addEventListener("progress",handleProgress.bind(null,"upload"))}}catch(err){}}if(xhr.upload){this._setUploadTimeout()}try{if(this.username&&this.password){xhr.open(this.method,this.url,true,this.username,this.password)}else{xhr.open(this.method,this.url,true)}}catch(err){return this.callback(err)}if(this._withCredentials)xhr.withCredentials=true;if(!this._formData&&this.method!=="GET"&&this.method!=="HEAD"&&typeof data!=="string"&&!this._isHost(data)){var contentType=this._header["content-type"];var _serialize=this._serializer||request.serialize[contentType?contentType.split(";")[0]:""];if(!_serialize&&isJSON(contentType)){_serialize=request.serialize["application/json"]}if(_serialize)data=_serialize(data)}for(var field in this.header){if(this.header[field]===null)continue;if(Object.prototype.hasOwnProperty.call(this.header,field))xhr.setRequestHeader(field,this.header[field])}if(this._responseType){xhr.responseType=this._responseType}this.emit("request",this);xhr.send(typeof data==="undefined"?null:data)};request.agent=function(){return new Agent};["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(method){Agent.prototype[method.toLowerCase()]=function(url,fn){var req=new request.Request(method,url);this._setDefaults(req);if(fn){req.end(fn)}return req}});Agent.prototype.del=Agent.prototype.delete;request.get=function(url,data,fn){var req=request("GET",url);if(typeof data==="function"){fn=data;data=null}if(data)req.query(data);if(fn)req.end(fn);return req};request.head=function(url,data,fn){var req=request("HEAD",url);if(typeof data==="function"){fn=data;data=null}if(data)req.query(data);if(fn)req.end(fn);return req};request.options=function(url,data,fn){var req=request("OPTIONS",url);if(typeof data==="function"){fn=data;data=null}if(data)req.send(data);if(fn)req.end(fn);return req};function del(url,data,fn){var req=request("DELETE",url);if(typeof data==="function"){fn=data;data=null}if(data)req.send(data);if(fn)req.end(fn);return req}request.del=del;request.delete=del;request.patch=function(url,data,fn){var req=request("PATCH",url);if(typeof data==="function"){fn=data;data=null}if(data)req.send(data);if(fn)req.end(fn);return req};request.post=function(url,data,fn){var req=request("POST",url);if(typeof data==="function"){fn=data;data=null}if(data)req.send(data);if(fn)req.end(fn);return req};request.put=function(url,data,fn){var req=request("PUT",url);if(typeof data==="function"){fn=data;data=null}if(data)req.send(data);if(fn)req.end(fn);return req}},{"./agent-base":23,"./is-object":25,"./request-base":26,"./response-base":27,"component-emitter":13,"fast-safe-stringify":14}],25:[function(require,module,exports){"use strict";function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function isObject(obj){return obj!==null&&_typeof(obj)==="object"}module.exports=isObject},{}],26:[function(require,module,exports){"use strict";function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}var isObject=require("./is-object");module.exports=RequestBase;function RequestBase(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in RequestBase.prototype){if(Object.prototype.hasOwnProperty.call(RequestBase.prototype,key))obj[key]=RequestBase.prototype[key]}return obj}RequestBase.prototype.clearTimeout=function(){clearTimeout(this._timer);clearTimeout(this._responseTimeoutTimer);clearTimeout(this._uploadTimeoutTimer);delete this._timer;delete this._responseTimeoutTimer;delete this._uploadTimeoutTimer;return this};RequestBase.prototype.parse=function(fn){this._parser=fn;return this};RequestBase.prototype.responseType=function(val){this._responseType=val;return this};RequestBase.prototype.serialize=function(fn){this._serializer=fn;return this};RequestBase.prototype.timeout=function(options){if(!options||_typeof(options)!=="object"){this._timeout=options;this._responseTimeout=0;this._uploadTimeout=0;return this}for(var option in options){if(Object.prototype.hasOwnProperty.call(options,option)){switch(option){case"deadline":this._timeout=options.deadline;break;case"response":this._responseTimeout=options.response;break;case"upload":this._uploadTimeout=options.upload;break;default:console.warn("Unknown timeout option",option)}}}return this};RequestBase.prototype.retry=function(count,fn){if(arguments.length===0||count===true)count=1;if(count<=0)count=0;this._maxRetries=count;this._retries=0;this._retryCallback=fn;return this};var ERROR_CODES=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];RequestBase.prototype._shouldRetry=function(err,res){if(!this._maxRetries||this._retries++>=this._maxRetries){return false}if(this._retryCallback){try{var override=this._retryCallback(err,res);if(override===true)return true;if(override===false)return false}catch(err2){console.error(err2)}}if(res&&res.status&&res.status>=500&&res.status!==501)return true;if(err){if(err.code&&ERROR_CODES.indexOf(err.code)!==-1)return true;if(err.timeout&&err.code==="ECONNABORTED")return true;if(err.crossDomain)return true}return false};RequestBase.prototype._retry=function(){this.clearTimeout();if(this.req){this.req=null;this.req=this.request()}this._aborted=false;this.timedout=false;return this._end()};RequestBase.prototype.then=function(resolve,reject){var _this=this;if(!this._fullfilledPromise){var self=this;if(this._endCalled){console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises")}this._fullfilledPromise=new Promise(function(resolve,reject){self.on("abort",function(){var err=new Error("Aborted");err.code="ABORTED";err.status=_this.status;err.method=_this.method;err.url=_this.url;reject(err)});self.end(function(err,res){if(err)reject(err);else resolve(res)})})}return this._fullfilledPromise.then(resolve,reject)};RequestBase.prototype.catch=function(cb){return this.then(undefined,cb)};RequestBase.prototype.use=function(fn){fn(this);return this};RequestBase.prototype.ok=function(cb){if(typeof cb!=="function")throw new Error("Callback required");this._okCallback=cb;return this};RequestBase.prototype._isResponseOK=function(res){if(!res){return false}if(this._okCallback){return this._okCallback(res)}return res.status>=200&&res.status<300};RequestBase.prototype.get=function(field){return this._header[field.toLowerCase()]};RequestBase.prototype.getHeader=RequestBase.prototype.get;RequestBase.prototype.set=function(field,val){if(isObject(field)){for(var key in field){if(Object.prototype.hasOwnProperty.call(field,key))this.set(key,field[key])}return this}this._header[field.toLowerCase()]=val;this.header[field]=val;return this};RequestBase.prototype.unset=function(field){delete this._header[field.toLowerCase()];delete this.header[field];return this};RequestBase.prototype.field=function(name,val){if(name===null||undefined===name){throw new Error(".field(name, val) name can not be empty")}if(this._data){throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()")}if(isObject(name)){for(var key in name){if(Object.prototype.hasOwnProperty.call(name,key))this.field(key,name[key])}return this}if(Array.isArray(val)){for(var i in val){if(Object.prototype.hasOwnProperty.call(val,i))this.field(name,val[i])}return this}if(val===null||undefined===val){throw new Error(".field(name, val) val can not be empty")}if(typeof val==="boolean"){val=String(val)}this._getFormData().append(name,val);return this};RequestBase.prototype.abort=function(){if(this._aborted){return this}this._aborted=true;if(this.xhr)this.xhr.abort();if(this.req)this.req.abort();this.clearTimeout();this.emit("abort");return this};RequestBase.prototype._auth=function(user,pass,options,base64Encoder){switch(options.type){case"basic":this.set("Authorization","Basic ".concat(base64Encoder("".concat(user,":").concat(pass))));break;case"auto":this.username=user;this.password=pass;break;case"bearer":this.set("Authorization","Bearer ".concat(user));break;default:break}return this};RequestBase.prototype.withCredentials=function(on){if(on===undefined)on=true;this._withCredentials=on;return this};RequestBase.prototype.redirects=function(n){this._maxRedirects=n;return this};RequestBase.prototype.maxResponseSize=function(n){if(typeof n!=="number"){throw new TypeError("Invalid argument")}this._maxResponseSize=n;return this};RequestBase.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}};RequestBase.prototype.send=function(data){var isObj=isObject(data);var type=this._header["content-type"];if(this._formData){throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()")}if(isObj&&!this._data){if(Array.isArray(data)){this._data=[]}else if(!this._isHost(data)){this._data={}}}else if(data&&this._data&&this._isHost(this._data)){throw new Error("Can't merge these send calls")}if(isObj&&isObject(this._data)){for(var key in data){if(Object.prototype.hasOwnProperty.call(data,key))this._data[key]=data[key]}}else if(typeof data==="string"){if(!type)this.type("form");type=this._header["content-type"];if(type==="application/x-www-form-urlencoded"){this._data=this._data?"".concat(this._data,"&").concat(data):data}else{this._data=(this._data||"")+data}}else{this._data=data}if(!isObj||this._isHost(data)){return this}if(!type)this.type("json");return this};RequestBase.prototype.sortQuery=function(sort){this._sort=typeof sort==="undefined"?true:sort;return this};RequestBase.prototype._finalizeQueryString=function(){var query=this._query.join("&");if(query){this.url+=(this.url.indexOf("?")>=0?"&":"?")+query}this._query.length=0;if(this._sort){var index=this.url.indexOf("?");if(index>=0){var queryArr=this.url.substring(index+1).split("&");if(typeof this._sort==="function"){queryArr.sort(this._sort)}else{queryArr.sort()}this.url=this.url.substring(0,index)+"?"+queryArr.join("&")}}};RequestBase.prototype._appendQueryString=function(){console.warn("Unsupported")};RequestBase.prototype._timeoutError=function(reason,timeout,errno){if(this._aborted){return}var err=new Error("".concat(reason+timeout,"ms exceeded"));err.timeout=timeout;err.code="ECONNABORTED";err.errno=errno;this.timedout=true;this.abort();this.callback(err)};RequestBase.prototype._setTimeouts=function(){var self=this;if(this._timeout&&!this._timer){this._timer=setTimeout(function(){self._timeoutError("Timeout of ",self._timeout,"ETIME")},this._timeout)}if(this._responseTimeout&&!this._responseTimeoutTimer){this._responseTimeoutTimer=setTimeout(function(){self._timeoutError("Response timeout of ",self._responseTimeout,"ETIMEDOUT")},this._responseTimeout)}}},{"./is-object":25}],27:[function(require,module,exports){"use strict";var utils=require("./utils");module.exports=ResponseBase;function ResponseBase(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in ResponseBase.prototype){if(Object.prototype.hasOwnProperty.call(ResponseBase.prototype,key))obj[key]=ResponseBase.prototype[key]}return obj}ResponseBase.prototype.get=function(field){return this.header[field.toLowerCase()]};ResponseBase.prototype._setHeaderProperties=function(header){var ct=header["content-type"]||"";this.type=utils.type(ct);var params=utils.params(ct);for(var key in params){if(Object.prototype.hasOwnProperty.call(params,key))this[key]=params[key]}this.links={};try{if(header.link){this.links=utils.parseLinks(header.link)}}catch(err){}};ResponseBase.prototype._setStatusProperties=function(status){var type=status/100|0;this.statusCode=status;this.status=this.statusCode;this.statusType=type;this.info=type===1;this.ok=type===2;this.redirect=type===3;this.clientError=type===4;this.serverError=type===5;this.error=type===4||type===5?this.toError():false;this.created=status===201;this.accepted=status===202;this.noContent=status===204;this.badRequest=status===400;this.unauthorized=status===401;this.notAcceptable=status===406;this.forbidden=status===403;this.notFound=status===404;this.unprocessableEntity=status===422}},{"./utils":28}],28:[function(require,module,exports){"use strict";exports.type=function(str){return str.split(/ *; */).shift()};exports.params=function(str){return str.split(/ *; */).reduce(function(obj,str){var parts=str.split(/ *= */);var key=parts.shift();var val=parts.shift();if(key&&val)obj[key]=val;return obj},{})};exports.parseLinks=function(str){return str.split(/ *, */).reduce(function(obj,str){var parts=str.split(/ *; */);var url=parts[0].slice(1,-1);var rel=parts[1].split(/ *= */)[1].slice(1,-1);obj[rel]=url;return obj},{})};exports.cleanHeader=function(header,changesOrigin){delete header["content-type"];delete header["content-length"];delete header["transfer-encoding"];delete header.host;if(changesOrigin){delete header.authorization;delete header.cookie}return header}},{}]},{},[2]);